<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dependency Tree Diff</title>

  <!-- Prism -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

  <!-- App CSS -->
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <main class="container">

    <header class="header">
      <h1>Dependency Tree Diff</h1>
      <p>Android 의존성 그래프 변경사항을 쉽게 비교해보세요</p>
    </header>

    <section class="card upload">

      <!-- 동적 경고 배너 (초기엔 숨김) -->
      <div id="notice" class="notice hidden" aria-live="polite">
        ⚠️ 파일이 너무 크면 비교 결과가 일부만 표시되거나 느려질 수 있습니다.
      </div>

      <div id="error" class="error"></div>
      <div class="grid">
        <div class="field">
          <label for="file-old">기존 의존성 파일 (.txt)</label>
          <div class="drop" id="drop-old" role="button" aria-label="기존 파일 선택">
            <input class="file-input" id="file-old" type="file" accept=".txt"/>
            <div class="hint">클릭 또는 드래그하여 업로드</div>
            <div class="name" id="name-old" aria-live="polite"></div>
          </div>
        </div>
        <div class="field">
          <label for="file-new">변경된 의존성 파일 (.txt)</label>
          <div class="drop" id="drop-new" role="button" aria-label="변경된 파일 선택">
            <input class="file-input" id="file-new" type="file" accept=".txt"/>
            <div class="hint">클릭 또는 드래그하여 업로드</div>
            <div class="name" id="name-new" aria-live="polite"></div>
          </div>
        </div>
      </div>

      <div class="actions">
        <button class="btn" id="btn-compare" disabled>
          <span id="btn-label">비교하기</span>
          <span id="spinner" class="spinner" style="display:none"></span>
        </button>
        <button class="btn btn-secondary" id="btn-reset" type="button">초기화</button>
      </div>
    
    </section>

    <section class="card result" id="result-card" style="display:none">
      <div class="result-header">
        <h2 class="result-title">비교 결과</h2>
        <button class="btn btn-secondary" id="btn-copy" type="button">결과 복사</button>
      </div>
      <div class="code-wrap">
        <pre><code class="language-diff" id="code-diff"></code></pre>
      </div>
    </section>

<section class="guide-section" id="guide-deptree" style="display:block">
  <h2 class="guide-title">의존성 트리 출력하는 방법</h2>

  <ol class="guide-steps">
    <li class="guide-step">
      <div class="guide-step-title">1. 변경 전 의존성 출력</div>
      <div class="guide-note">현재 <strong>develop</strong> 브랜치 또는 변경 전 브랜치에서 실행해 주세요.</div>
      <div class="guide-block">
        <div class="guide-label">명령어</div>
        <pre class="guide-code"><code class="">./gradlew app:dependencies --configuration {BuildVariant명} &gt; before.txt</code></pre>
      </div>
    </li>

    <li class="guide-step">
      <div class="guide-step-title">2. 변경 후 의존성 출력</div>
      <div class="guide-note">브랜치를 옮긴 후 동일한 명령어로 <strong>파일명만 다르게</strong> 저장합니다.</div>
      <div class="guide-block">
        <div class="guide-label">명령어</div>
        <pre class="guide-code"><code class="">./gradlew app:dependencies --configuration {BuildVariant명} &gt; after.txt</code></pre>
      </div>
    
    </li>

    <li class="guide-step">
      <div class="guide-step-title">3. 비교하기</div>
      <div class="guide-note">위에서 저장한 <code>before.txt</code>와 <code>after.txt</code>를 업로드해 보세요.</div>
    </li>
  </ol>
</section>
  </main>

  <!-- Core (diff 로직) 먼저 로드 -->
  <script defer src="./dependency-diff.js"></script>
  <!-- UI -->
  <script defer src="./app.js"></script>
</body>
</html>